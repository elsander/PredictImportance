StoufferZTransform <- function(ps){
  ##Note: these p-values must be converted to one-sided
  ##p-values before calling this function
  ##reference: "Combining probability from independent tests:
  ##the weighted Z-method is superior to Fisher's approach"
  ##Whitlock 2005
  k <- length(ps)
  Zs <- sum(qnorm(ps))/sqrt(k)
  ##convert to pvalue by finding the probability of a more extreme Z
  ##the values must be multiplied by 2 to account for the fact that
  ##it is a two-tailed test
  newp <- min(pnorm(Zs), 1 - pnorm(Zs))*2
  return(newp)
}
